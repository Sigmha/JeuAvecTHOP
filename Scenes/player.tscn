[gd_scene load_steps=53 format=3 uid="uid://b43h0vguqe8jw"]

[ext_resource type="Script" path="res://Scripts/Player/Player.gd" id="1_na8sa"]
[ext_resource type="PackedScene" uid="uid://bc5ea8icchh2o" path="res://Scenes/weapon.tscn" id="2_ii4go"]
[ext_resource type="Texture2D" uid="uid://bdxg03nx7tcyb" path="res://Assets/Player/player_spritesheet.png" id="3_sg5fa"]
[ext_resource type="Texture2D" uid="uid://bu4fujg5jd5hy" path="res://Assets/Player/test_player_spritesheet.png" id="4_c7r1f"]
[ext_resource type="Script" path="res://Scripts/Player/StateMachine.gd" id="5_q3hq0"]
[ext_resource type="Script" path="res://Scripts/Player/PlayerCombatMove.gd" id="6_sjw7j"]
[ext_resource type="Script" path="res://Scripts/Player/PlayerAttack.gd" id="7_mhdk2"]
[ext_resource type="Script" path="res://Scripts/Player/TouchedLabel.gd" id="7_oidbd"]
[ext_resource type="Script" path="res://Scripts/Player/PlayerHit.gd" id="9_ifbag"]
[ext_resource type="Script" path="res://Scripts/Player/PlayerRolling.gd" id="10_6tsuu"]
[ext_resource type="Script" path="res://Scripts/Player/PlayerCityMove.gd" id="11_r5y8r"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_1vnpl"]
radius = 3.0
height = 28.0

[sub_resource type="AtlasTexture" id="AtlasTexture_ia1sw"]
atlas = ExtResource("3_sg5fa")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_tgeiu"]
atlas = ExtResource("3_sg5fa")
region = Rect2(32, 0, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_5idhf"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ia1sw")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_tgeiu")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[sub_resource type="AtlasTexture" id="AtlasTexture_82uqu"]
atlas = ExtResource("3_sg5fa")
region = Rect2(0, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_i7fcf"]
atlas = ExtResource("3_sg5fa")
region = Rect2(32, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_frpha"]
atlas = ExtResource("3_sg5fa")
region = Rect2(0, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_an43w"]
atlas = ExtResource("3_sg5fa")
region = Rect2(32, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_b1l32"]
atlas = ExtResource("3_sg5fa")
region = Rect2(0, 64, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_mjgxt"]
atlas = ExtResource("3_sg5fa")
region = Rect2(32, 64, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_hcgma"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_82uqu")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_i7fcf")
}],
"loop": true,
"name": &"HighArm",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_frpha")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_an43w")
}],
"loop": true,
"name": &"LowArm",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_b1l32")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_mjgxt")
}],
"loop": true,
"name": &"MediumArm",
"speed": 5.0
}]

[sub_resource type="AtlasTexture" id="AtlasTexture_srsjb"]
atlas = ExtResource("4_c7r1f")
region = Rect2(0, 128, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_iemcm"]
atlas = ExtResource("4_c7r1f")
region = Rect2(32, 128, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_vvp7p"]
atlas = ExtResource("4_c7r1f")
region = Rect2(64, 128, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_hylr3"]
atlas = ExtResource("4_c7r1f")
region = Rect2(96, 128, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_m78iq"]
atlas = ExtResource("4_c7r1f")
region = Rect2(128, 128, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_d75jl"]
atlas = ExtResource("4_c7r1f")
region = Rect2(160, 128, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_dmpsd"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_srsjb")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_iemcm")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_vvp7p")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_hylr3")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_m78iq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_d75jl")
}],
"loop": false,
"name": &"default",
"speed": 6.0
}]

[sub_resource type="AtlasTexture" id="AtlasTexture_poicx"]
atlas = ExtResource("4_c7r1f")
region = Rect2(0, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_1rov8"]
atlas = ExtResource("4_c7r1f")
region = Rect2(32, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_rdhx3"]
atlas = ExtResource("4_c7r1f")
region = Rect2(64, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_y54ol"]
atlas = ExtResource("4_c7r1f")
region = Rect2(96, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ob7bq"]
atlas = ExtResource("4_c7r1f")
region = Rect2(128, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_7ui3s"]
atlas = ExtResource("4_c7r1f")
region = Rect2(160, 160, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_vedly"]
atlas = ExtResource("4_c7r1f")
region = Rect2(0, 192, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8vj1f"]
atlas = ExtResource("4_c7r1f")
region = Rect2(32, 192, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_qy2sm"]
atlas = ExtResource("4_c7r1f")
region = Rect2(64, 192, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_v88vb"]
atlas = ExtResource("4_c7r1f")
region = Rect2(96, 192, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_qc066"]
atlas = ExtResource("4_c7r1f")
region = Rect2(128, 192, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_ey3xb"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_poicx")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_1rov8")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_rdhx3")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_y54ol")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ob7bq")
}, {
"duration": 3.0,
"texture": SubResource("AtlasTexture_7ui3s")
}, {
"duration": 2.0,
"texture": SubResource("AtlasTexture_vedly")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8vj1f")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_qy2sm")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_v88vb")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_qc066")
}],
"loop": false,
"name": &"default",
"speed": 14.0
}]

[sub_resource type="AtlasTexture" id="AtlasTexture_j7hbc"]
atlas = ExtResource("4_c7r1f")
region = Rect2(0, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_23drh"]
atlas = ExtResource("4_c7r1f")
region = Rect2(32, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_pfm81"]
atlas = ExtResource("4_c7r1f")
region = Rect2(64, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_70k0t"]
atlas = ExtResource("4_c7r1f")
region = Rect2(96, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_lstpe"]
atlas = ExtResource("4_c7r1f")
region = Rect2(32, 224, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wwl7b"]
atlas = ExtResource("4_c7r1f")
region = Rect2(64, 224, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_nx5eg"]
atlas = ExtResource("4_c7r1f")
region = Rect2(96, 224, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_pbtbq"]
atlas = ExtResource("4_c7r1f")
region = Rect2(128, 224, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_qyjlj"]
atlas = ExtResource("4_c7r1f")
region = Rect2(160, 224, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_sejmj"]
atlas = ExtResource("4_c7r1f")
region = Rect2(0, 224, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_0exs4"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_j7hbc")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_23drh")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pfm81")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_70k0t")
}],
"loop": true,
"name": &"Idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_lstpe")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wwl7b")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_nx5eg")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pbtbq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_qyjlj")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_sejmj")
}],
"loop": true,
"name": &"Walk",
"speed": 7.0
}]

[node name="Player" type="CharacterBody2D" groups=["Joueur"]]
script = ExtResource("1_na8sa")

[node name="PlayerCollision" type="CollisionShape2D" parent="."]
position = Vector2(0, -14)
shape = SubResource("CapsuleShape2D_1vnpl")

[node name="ColorRect" type="ColorRect" parent="PlayerCollision"]
offset_left = -3.0
offset_top = -14.0
offset_right = 3.0
offset_bottom = 14.0
color = Color(1, 0, 1, 0.278431)

[node name="Weapon" parent="." instance=ExtResource("2_ii4go")]
position = Vector2(3, -23)

[node name="PlayerSpriteComposition" type="Node2D" parent="."]

[node name="BodySprite" type="AnimatedSprite2D" parent="PlayerSpriteComposition"]
position = Vector2(1.49012e-08, -16)
sprite_frames = SubResource("SpriteFrames_5idhf")

[node name="Arm" type="AnimatedSprite2D" parent="PlayerSpriteComposition"]
position = Vector2(0, -16)
sprite_frames = SubResource("SpriteFrames_hcgma")
animation = &"HighArm"

[node name="Rolling" type="AnimatedSprite2D" parent="PlayerSpriteComposition"]
visible = false
position = Vector2(0, -16)
sprite_frames = SubResource("SpriteFrames_dmpsd")

[node name="Hit" type="AnimatedSprite2D" parent="PlayerSpriteComposition"]
visible = false
position = Vector2(0, -16)
sprite_frames = SubResource("SpriteFrames_ey3xb")

[node name="CityMove" type="AnimatedSprite2D" parent="PlayerSpriteComposition"]
visible = false
position = Vector2(0, -16)
sprite_frames = SubResource("SpriteFrames_0exs4")
animation = &"Idle"

[node name="TouchedLabel" type="Label" parent="."]
offset_left = -14.0
offset_top = -38.0
offset_right = 50.0
offset_bottom = -15.0
scale = Vector2(0.298121, 0.298121)
text = "touched"
script = ExtResource("7_oidbd")

[node name="TouchedTimer" type="Timer" parent="TouchedLabel"]
wait_time = 1.5
one_shot = true

[node name="StateMachine" type="Node2D" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("5_q3hq0")
initial_state = NodePath("PlayerCombatMove")

[node name="PlayerCombatMove" type="Node" parent="StateMachine" node_paths=PackedStringArray("character", "character_collision", "body_sprite", "arm_sprite", "weapon")]
script = ExtResource("6_sjw7j")
character = NodePath("../..")
character_collision = NodePath("../../PlayerCollision")
body_sprite = NodePath("../../PlayerSpriteComposition/BodySprite")
arm_sprite = NodePath("../../PlayerSpriteComposition/Arm")
weapon = NodePath("../../Weapon")

[node name="PlayerAttack" type="Node" parent="StateMachine" node_paths=PackedStringArray("character", "character_collision", "body_sprite", "arm_sprite", "weapon")]
script = ExtResource("7_mhdk2")
character = NodePath("../..")
character_collision = NodePath("../../PlayerCollision")
body_sprite = NodePath("../../PlayerSpriteComposition/BodySprite")
arm_sprite = NodePath("../../PlayerSpriteComposition/Arm")
weapon = NodePath("../../Weapon")
immobile_timing = 0.1

[node name="PlayerHit" type="Node" parent="StateMachine" node_paths=PackedStringArray("character", "character_collision", "hit_sprite", "weapon")]
script = ExtResource("9_ifbag")
character = NodePath("../..")
character_collision = NodePath("../../PlayerCollision")
hit_sprite = NodePath("../../PlayerSpriteComposition/Hit")
weapon = NodePath("../../Weapon")

[node name="PlayerRolling" type="Node" parent="StateMachine" node_paths=PackedStringArray("character", "character_collision", "rolling_sprite", "weapon")]
script = ExtResource("10_6tsuu")
character = NodePath("../..")
character_collision = NodePath("../../PlayerCollision")
rolling_sprite = NodePath("../../PlayerSpriteComposition/Rolling")
weapon = NodePath("../../Weapon")

[node name="PlayerCityMove" type="Node" parent="StateMachine" node_paths=PackedStringArray("character", "character_collision", "city_move_sprite", "weapon")]
script = ExtResource("11_r5y8r")
character = NodePath("../..")
character_collision = NodePath("../../PlayerCollision")
city_move_sprite = NodePath("../../PlayerSpriteComposition/CityMove")
weapon = NodePath("../../Weapon")
move_speed = 300

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(0, -53)
position_smoothing_enabled = true

[connection signal="dummy_touched" from="Weapon" to="." method="_on_weapon_dummy_touched"]
[connection signal="weapon_touched" from="Weapon" to="." method="_on_weapon_weapon_touched"]
[connection signal="timeout" from="TouchedLabel/TouchedTimer" to="TouchedLabel" method="_on_touched_timer_timeout"]
